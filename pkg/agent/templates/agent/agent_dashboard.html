<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Agent Dashboard - JoyXpress</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css" rel="stylesheet">
<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" rel="stylesheet">

<style>
/* Sidebar */
#wrapper { display: flex; }
#sidebar-wrapper { width: 250px; min-height: 100vh; background-color: #343a40; color: white; }
#sidebar-wrapper .sidebar-heading { padding: 1.5rem; font-size: 1.5rem; background-color: #ff6600; font-weight: 700; }
.sidebar-link { color: #adb5bd; display: block; padding: 15px 25px; text-decoration: none; }
.sidebar-link:hover, .sidebar-link.active { background-color: #3e444a; color: #fff; border-left: 4px solid #ff6600; }
.sidebar-profile { padding: 20px; text-align: center; border-bottom: 1px solid #4b545c; }
.user-avatar-circle { width: 60px; height: 60px; background-color: #ff6600; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 24px; margin: 0 auto 10px; font-weight: bold; }

/* Content */
#page-content-wrapper { width: 100%; }
.dashboard-card { background: white; border-radius: 10px; padding: 25px; box-shadow: 0 0 15px rgba(0,0,0,0.05); margin-bottom: 20px; }
.icon-box { width: 50px; height: 50px; border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 20px; margin-right: 15px; }
.bg-blue-soft { background-color: #e6f7ff; color: #007bff; }
.bg-orange-soft { background-color: #fff3e6; color: #ff6600; }
.bg-green-soft { background-color: #e6ffed; color: #28a745; }

.table-custom thead th { border-top: none; border-bottom: 2px solid #f4f6f9; text-transform: uppercase; font-size: 0.85rem; }
.table-custom tbody td { vertical-align: middle; border-top: 1px solid #f4f6f9; padding: 15px 0.75rem; }

@media (min-width: 768px) {
    #sidebar-wrapper { position: fixed; }
    #page-content-wrapper { margin-left: 250px; }
}
</style>
</head>
<body>
<div id="wrapper">

<!-- Sidebar -->
<div id="sidebar-wrapper">
    <div class="sidebar-heading"><i class="fas fa-truck mr-2"></i>JoyXpress</div>
    <div class="sidebar-profile">
        <div class="user-avatar-circle">{{ agent.full_name[0]|upper }}</div>
        <h6 class="mb-0">{{ agent.full_name|title }}</h6>
        <small>{{ 'Active' if agent.is_active else 'Inactive' }}</small>
    </div>
    <a href="{{ url_for('bpagent.agent_dashboard') }}" class="sidebar-link active"><i class="fas fa-tachometer-alt sidebar-icon"></i> Dashboard</a>
    <a href="{{ url_for('bpshipment.track_ship_page') }}" class="sidebar-link"><i class="fas fa-search-location sidebar-icon"></i> Track Package</a>
    <a href="{{ url_for('bpshipment.shipment_history') }}" class="sidebar-link"><i class="fas fa-history sidebar-icon"></i> History</a>
    <a href="{{ url_for('bpagent.agent_logout') }}" class="sidebar-link text-danger"><i class="fas fa-sign-out-alt sidebar-icon"></i> Logout</a>
</div>

<!-- Page Content -->
<div id="page-content-wrapper" class="p-4">

<h2>Welcome, {{ agent.full_name|title }}</h2>
<div class="row">
    <div class="col-lg-4 col-md-6">
        <div class="dashboard-card d-flex align-items-center">
            <div class="icon-box bg-blue-soft"><i class="fas fa-box"></i></div>
            <div>
                <h5>Total Shipments</h5>
                <h2>{{ total_shipments }}</h2>
            </div>
        </div>
    </div>
    <div class="col-lg-4 col-md-6">
        <div class="dashboard-card d-flex align-items-center">
            <div class="icon-box bg-orange-soft"><i class="fas fa-shipping-fast"></i></div>
            <div>
                <h5>Pending / In Transit</h5>
                <h2>{{ active_shipments }}</h2>
            </div>
        </div>
    </div>
    <div class="col-lg-4 col-md-6">
        <div class="dashboard-card d-flex align-items-center">
            <div class="icon-box bg-green-soft"><i class="fas fa-user-check"></i></div>
            <div>
                <h5>Account Status</h5>
                <h2>{{ 'Active' if agent.is_active else 'Inactive' }}</h2>
            </div>
        </div>
    </div>
</div>

<!-- Recent Shipments -->
<div class="dashboard-card">
<h5>Recent Shipments</h5>
<div class="table-responsive">
<table class="table table-custom table-hover">
<thead>
<tr>
<th>Tracking ID</th>
<th>Date Created</th>
<th>Destination</th>
<th>Status</th>
<th>Action</th>
</tr>
</thead>
<tbody>
{% for s in shipments[:5] %}
<tr>
<td>#{{ s.tracking_number }}</td>
<td>{{ s.created_at.strftime('%b %d, %Y') }}</td>
<td>{{ s.delivery_city }}</td>
<td>
{% if s.status|lower == 'delivered' %}
<span class="badge badge-success">Delivered</span>
{% elif s.status|lower == 'pending' %}
<span class="badge badge-secondary">Pending</span>
{% else %}
<span class="badge badge-warning">{{ s.status|capitalize }}</span>
{% endif %}
</td>
<td>
<a href="{{ url_for('bpshipment.shipment_details', shipment_id=s.id) }}" class="btn btn-sm btn-outline-primary">View</a>
</td>
</tr>
{% else %}
<tr>
<td colspan="5" class="text-center py-5 text-muted">No shipments assigned yet.</td>
</tr>
{% endfor %}
</tbody>
</table>
</div>
</div>

</div>
</div>

<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.bundle.min.js"></script>
</body>
</html>
